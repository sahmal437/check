"use strict";!function(s){function i(e,t){if(e=e,!(null!=(t=t)&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?t[Symbol.hasInstance](e):e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function e(e,t,n){t&&o(e.prototype,t),n&&o(e,n)}var r=function(){function n(e,t){i(this,n),this.widgetType=e,this.widgetCode=t}return e(n,[{key:"getWidgetType",value:function(){return this.widgetType}},{key:"getWidgetCode",value:function(){return this.widgetCode}},{key:"toJSON",value:function(){return{widgetType:this.widgetType,widgetCode:this.widgetCode}}}]),n}(),c=function(){function t(e){i(this,t),this.widgetStorage=e}return e(t,[{key:"copy",value:function(e){this.widgetStorage.save(e)}}]),t}(),l=function(){function t(e){i(this,t),this.storageKey=e,xdLocalStorage.init({iframeUrl:"https://happyaddons.com/marvin/index.html",initCallback:function(){}})}return e(t,[{key:"save",value:function(e){xdLocalStorage.setItem(this.storageKey,JSON.stringify(e))}},{key:"fetch",value:function(t){return xdLocalStorage.getItem(this.storageKey,function(e){e=JSON.parse(e.value),e=new r(e.widgetType,e.widgetCode);t(e)})}}]),t}(),d=function(){function o(e,t,n){i(this,o),this.storageKey=e,this.storageEndpoint=t,this.$=n}return e(o,[{key:"save",value:function(e){this.$.post(this.storageEndpoint,{key:this.storageKey,data:JSON.stringify(e)})}},{key:"fetch",value:function(t){this.$.get(this.storageEndpoint,{key:this.storageKey},function(e){e=JSON.parse(e),e=new r(e.widgetType,e.widgetCode);t(e)})}}]),o}();s(window).on("elementor/frontend/init",function(){var e=s("#ha-live-copy-base").clone().removeAttr("id").removeAttr("style"),t=s(".elementor-section-wrap > .elementor-section"),n=s(".e-container"),o=s("body").hasClass("elementor-editor-active"),i=s(document),n=(t.length<=0&&(t=s(".elementor-section.elementor-top-section")),t=s.merge(t,n),o||t.filter(function(e,t){var t=s(t),n=t.data("settings"),n=n&&n._ha_enable_live_copy&&"yes"===n._ha_enable_live_copy;return n=t.hasClass("e-container")&&t.parents(".e-container").length?!1:n}).append(e),t.on("click.HappyAddonsLiveCopy",".ha-live-copy-btn",function(e){e.preventDefault();var e=s(e.delegateTarget).data(),t=s(this),n=t.parents("[data-elementor-id]").data("elementor-id");t.hasClass("on-progress")||"section"!==e.element_type&&"container"!==e.element_type||(i.trigger({type:"onHappyAddonsLiveCopy",sectionId:e.id,elType:e.element_type,postID:n}),t.addClass("on-progress"))}),/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?new d(livecopy.storagekey,"https://happymonster.dev/storage/safari.php",s):new l(livecopy.storagekey)),a=new c(n);i.on("onHappyAddonsLiveCopy",function(n){var o=s('[data-id="'+n.sectionId+'"] .ha-live-copy-btn');o.css("cursor","progress"),s.get(livecopy.ajax_url,{action:"get_section_data",section_id:n.sectionId,elType:n.elType,post_id:n.postID,nonce:livecopy.nonce}).done(function(e){var t;e.success?(e=new r(n.elType,e.data),a.copy(e),t=setTimeout(function(){o.removeAttr("style").text("Copied").removeClass("on-progress"),clearTimeout(t);var e=setTimeout(function(){o.text("Live Copy"),clearTimeout(e)},1e3)},500)):console.log("Something is wrong!")})})})}(jQuery);